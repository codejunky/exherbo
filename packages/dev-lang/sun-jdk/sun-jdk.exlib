# Copyright (c) 2009 Jan Meier
# Distributed under the terms of the GNU General Public License v2

SUMMARY="SDK for the Java programming language"
HOMEPAGE="http://java.sun.com"
LICENCES="SUN"

FILE_NAME="jdk-$(ever range 2)u$(ever range 4)-dlj-linux"
DOWNLOADS=" platform:amd64? ( http://download.java.net/dlj/binaries/${FILE_NAME}-amd64.bin )
            platform:x86? ( http://download.java.net/dlj/binaries/${FILE_NAME}-i586.bin )"

MYOPTIONS="platform: amd64 x86"
DIRECTORY_NAME="jdk$(ever range -3)_$(ever range 4)"
WORK=${WORKBASE}/${DIRECTORY_NAME}

src_unpack() {
    if option platform:x86; then
        sh "${FETCHEDDIR}/${FILE_NAME}-i586.bin" --accept-license --unpack || die "Could not unpack"
    fi

    if option platform:amd64; then
        sh "${FETCHEDDIR}/${FILE_NAME}-amd64.bin" --accept-license --unpack || die "Could not unpack"
    fi
}

src_install() {
    INSTALL_PATH=/opt/${DIRECTORY_NAME}
    dodir ${INSTALL_PATH}
    edo cp -vR "${WORK}"/* "${IMAGE}"/${INSTALL_PATH}

    keepdir "${INSTALL_PATH}/jre/lib/applet"
    keepdir "${INSTALL_PATH}/db/demo/programs/localcal/lib"

    # TODO: nsplugin? java plugin for mozilla firefox
    hereenvd 90java <<EOF
MANPATH="${INSTALL_PATH}/man"
PATH="${INSTALL_PATH}/bin"
MOZ_PLUGIN_PATH="${INSTALL_PATH}/jre/plugin/i386/ns7/"
COLON_SEPARATED="MOZ_PLUGIN_PATH"
EOF
}
