# Copyright (c) 2009 Jan Meier
# Distributed under the terms of the GNU General Public License v2

SUMMARY="SDK for the Java programming language"
HOMEPAGE="http://java.sun.com"
LICENCES="SUN"

FILE_NAME="jdk-$(ever range 2 ${PV})u$(ever range 4 ${PV})-dlj-linux"
DOWNLOADS=" platform:amd64? ( http://download.java.net/dlj/binaries/${FILE_NAME}-amd64.bin )
            platform:x86? ( http://download.java.net/dlj/binaries/${FILE_NAME}-i586.bin )"

MYOPTIONS="platform: amd64 x86"
DIRECTORY_NAME="jdk$(ever range -3 ${PV})_$(ever range 4 ${PV})"
WORK="${WORKBASE}/${DIRECTORY_NAME}"

src_unpack() {
    if option platform:x86; then
        sh "${FETCHEDDIR}/${FILE_NAME}-i586.bin" --accept-license --unpack || die "Could not unpack"
    fi;

    if option platform:amd64; then
        sh "${FETCHEDDIR}/${FILE_NAME}-amd64.bin" --accept-license --unpack || die "Could not unpack"
    fi;
}

src_install() {
    mkdir -p "${IMAGE}/opt/" || die "Could not create directory"
    cp -vR "${WORKBASE}/${DIRECTORY_NAME}" "${IMAGE}/opt/" || die "could not copy files"
    keepdir "/opt/${DIRECTORY_NAME}/jre/lib/applet"
    keepdir "/opt/${DIRECTORY_NAME}/db/demo/programs/localcal/lib"
    hereenvd 90java <<EOF
PATH="/opt/${DIRECTORY_NAME}/bin"
EOF

}
